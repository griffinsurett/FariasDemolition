---
import { Image } from "astro:assets";
import { Icon } from "astro-icon/components";
import Logo from "@/assets/farias.png";
import Button from "@/components/Button/Button";
import SocialLinks from "@/components/SocialLinks.astro";
import HeaderMenu from "@/components/Navigation/HeaderMenu";
import MobileMenu from "@/components/Navigation/MobileMenu";
import { contactItems } from "@/SiteData.js";

const menuItems = [
  { label: "Home", href: "/" },
  { label: "About Us", href: "#about" },
  { label: "Services", href: "#services" },
  { label: "Projects", href: "#projects" },
  { label: "Testimonials", href: "#testimonials" },
  { label: "Contact Us", href: "#quote" },
  { label: "Subcontract Us", href: "#subcontract" },
];

const contactIconClasses = "text-white";
const contactIconTextClasses = "text-base hidden lg:block";

// Determine which item is initially active
const currentPath = Astro.url.pathname;
const enhancedMenuItems = menuItems.map(item => ({
  ...item,
  active: item.href === currentPath || (currentPath === '/' && item.href === '/')
}));
---

<header class="w-full sticky top-0 z-50">
  <!-- Top contact bar -->
  <div
    class="w-full mx-auto flex justify-between items-center text-sm bg-primary text-white py-2 px-5"
  >
    <!-- Social Media Icons (hide on mobile) -->
    <div class="hidden sm:flex items-center space-x-4">
      <SocialLinks />
    </div>

    <!-- Mobile: Show only essential contact -->
    <div class="flex sm:hidden items-center space-x-4">
      <a href="tel:732-374-1957" class="flex items-center text-white hover:opacity-80">
        <Icon name="fa6-solid:phone" size="16" class="text-white" />
      </a>
      <a href="mailto:fariasdemolition@gmail.com" class="flex items-center text-white hover:opacity-80">
        <Icon name="fa6-solid:envelope" size="16" class="text-white" />
      </a>
    </div>

    <!-- Contact Info (desktop) -->
    <div class="hidden sm:flex items-center space-x-6 py-1 h6">
      {
        contactItems.map(({ href, icon, label }) => 
          <Button
            variant="link"
            href={href ? href : undefined}
            className="flex items-center space-x-1 hover:opacity-80 transition-opacity"
          >
            <Icon name={icon} size="20" class={contactIconClasses} />
            <span class={contactIconTextClasses}>{label}</span>
          </Button>
        )
      }
    </div>

    <!-- Mobile: Compact contact display -->
    <div class="flex sm:hidden items-center">
      <span class="text-xs">732-374-1957</span>
    </div>
  </div>

  <!-- Main navigation -->
  <div class="bg-light-primary shadow-sm">
    <div class="w-95/100 mx-auto px-5">
      <div class="flex items-center justify-between min-h-18">
        <!-- Logo -->
        <div class="flex-shrink-0 flex items-center">
          <a href="/" class="w-16 h-16 lg:w-20 lg:h-20 rounded flex items-center justify-center">
            <Image
              src={Logo}
              alt={"Faria's Demolition"}
              height={65}
              width={65}
              class="w-12 h-12 lg:w-16 lg:h-16"
            />
          </a>
        </div>

        <!-- Desktop Navigation -->
        <div class="hidden lg:flex items-center">
          <HeaderMenu 
            items={enhancedMenuItems} 
            client:load
          />
          
          <!-- Get Quote Button -->
          <div class="flex-shrink-0 px-3">
            <Button variant="primary" href="#quote">Get Quote</Button>
          </div>
        </div>

        <!-- Mobile Menu Button -->
        <MobileMenu 
          items={enhancedMenuItems}
          showGetQuoteButton={true}
          client:load
        />
      </div>
    </div>
  </div>
</header>

<style>
  /* Ensure header stays on top */
  header {
    position: sticky;
    top: 0;
    z-index: 50;
  }
</style>